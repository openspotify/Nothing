name: ðŸ” Replit Pinger

on:
  schedule:
    - cron: "* * * * *"  # â° Every minute
  workflow_dispatch:     # ðŸ–±ï¸ Optional: Manual trigger

jobs:
  ping-replit:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@v3

      - name: ðŸ” Loop ping to Replit (every 5s for 1 min)
        run: |
          mkdir -p logs
          echo "ðŸ“… Log started at $(date)" >> logs/ping-logs.txt
          for i in {1..60}
          do
            STATUS=$(curl -s -o /dev/null -w "%{http_code}" https://240a81b0-7fc0-4b2f-9a81-75a2ad07195b-00-3grvtt2u4ccmw.pike.replit.dev/)
            echo "[$(date '+%T')] Ping $i => Status: $STATUS" >> logs/ping-logs.txt
            sleep 5
          done
          echo "âœ… Log ended at $(date)" >> logs/ping-logs.txt

      - name: ðŸ’¾ Commit ping logs
        run: |
          git config user.name "openspotify"
          git config user.email "openspotify@users.noreply.github.com"
          git add logs/ping-logs.txt
          git commit -m "ðŸ“Œ Ping log update at $(date '+%T')" || echo "ðŸŒ€ No changes to commit"
          git push
