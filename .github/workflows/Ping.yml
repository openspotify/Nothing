name: ğŸ” Replit Pinger

on:
  schedule:
    - cron: "* * * * *"  # â° Every minute
  workflow_dispatch:     # ğŸ–±ï¸ Optional: Manual trigger

jobs:
  ping-replit:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repo
        uses: actions/checkout@v3

      - name: ğŸ” Loop ping to Replit (every 5s for 1 min)
        run: |
          mkdir -p logs
          echo "ğŸ“… Log started at $(date)" >> logs/ping-logs.txt
          for i in {1..60}
          do
            STATUS=$(curl -s -o /dev/null -w "%{http_code}" https://240a81b0-7fc0-4b2f-9a81-75a2ad07195b-00-3grvtt2u4ccmw.pike.replit.dev/)
            echo "[$(date '+%T')] Ping $i => Status: $STATUS" >> logs/ping-logs.txt
            sleep 5
          done
          echo "âœ… Log ended at $(date)" >> logs/ping-logs.txt

           - name: ğŸ“¦ Commit and Push Logs
        env:
          GH_TOKEN: ${{ secrets.GH_PAT }}
        run: |
          git config --global user.name "Replit Bot"
          git config --global user.email "replitbot@users.noreply.github.com"
          git add logs/
          git commit -m "ğŸ“„ Log ping $(date '+%Y-%m-%d %H:%M:%S')" || echo "ğŸªµ Nothing to commit"
          git push https://x-access-token:${GH_TOKEN}@github.com/${{ github.repository }} HEAD:main || echo "â¬†ï¸ Push failed"
